---
import Layout from "../../layouts/Layout.astro";
export function getStaticPaths() {
  return [
    {params: {programa: 'recreativo'}},
    {params: {programa: 'desporto'}},
    {params: {programa: 'comunicação'}},
    {params: {programa: 'pedagogia'}},
  ];
}

const { programa } = Astro.params;
                    
---

<style>
    #departamento-intro{
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 80%;
    }
    #departamento-seccoes{
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    main{
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100vh;
    }

    p{
        text-align: justify;
    }
</style>

<Layout title="Lista E 2023">
	<main>
		<h1 id="departamento-nome">{programa.toUpperCase()}</h1>
        <p id="departamento-intro">

        </p>
        <div id="departamento-seccoes">
            
        </div>
	</main>
</Layout>


<script>
    import FirebaseSingleton from '../../firebase.js'
    import { doc, getDoc } from 'firebase/firestore'
    const roxo_escuro = "#311547"
    const roxo_claro = "#CFB6E2"
    const amarelo_escuro = "#FFEE70"
	
    const departamentoNome = document.getElementById('departamento-nome').innerText.toLowerCase()
    await FirebaseSingleton.initialize();
    FirebaseSingleton.getFirestoreInstance().then(
                    firestore => {
                        getDoc(doc(firestore,"programa",departamentoNome)).then(
                            doc => {
                                if (doc.exists()) {
                                    
                                    const data = doc.data()
                                    console.log(data)
                                    if(data.introducao){
                                        document.getElementById('departamento-intro').innerText = data.introducao
                                    }
                                    if(data["section-titles"]){
                                        const seccoes = document.getElementById('departamento-seccoes')
    
                                        for(let i = 0; i < data["section-titles"].length; i++){
                                            const seccaoDiv = document.createElement('div')
                                            seccaoDiv.classList.add('div-seccao')
                                            const seccaoTitulo = document.createElement('h2')
                                            const seccaoTexto = document.createElement('p')
                                            seccaoTexto.innerHTML = data["section-texts"][i]
                                            seccaoTitulo.innerHTML = data["section-titles"][i]
                                            //set title style
                                            seccaoTitulo.style.backgroundColor = roxo_escuro
                                            seccaoTitulo.style.padding = '10px 50px 10px 50px'
                                            seccaoTitulo.style.color = amarelo_escuro
                                            seccaoTitulo.style.margin = '0px'
                                            seccaoTitulo.style.display = 'flex'
                                            seccaoTitulo.style.alignItems = 'center'
                                            seccaoTitulo.style.justifyContent = 'center'
                                            seccaoTitulo.style.height = '100%'

                                            // set text style
                                            seccaoTexto.style.textAlign = 'justify'
                                            seccaoTexto.style.display = 'flex'
                                            seccaoTexto.style.flexDirection = 'column'
                                            seccaoTexto.style.alignItems = 'center'
                                            seccaoTexto.style.margin = '0px'
                                            seccaoTexto.style.justifyContent = 'center'
                                            seccaoTexto.style.backgroundColor = roxo_claro
                                            seccaoTexto.style.padding = '10px 50px 10px 50px'
                                            seccaoTexto.style.height = '100%'
                                           

                                            // set div style
                                            seccaoDiv.style.display = 'flex'
                                            seccaoDiv.style.flexDirection = 'row'
                                            seccaoDiv.style.gap = '15px'
                                            seccaoDiv.style.width = '80%'
                                            
                                            seccaoDiv.style.marginBottom = '50px'
                                            
                                            if(i%2 == 0){
                                                seccaoDiv.appendChild(seccaoTitulo)
                                                seccaoDiv.appendChild(seccaoTexto)
                                            } else {
                                                seccaoDiv.appendChild(seccaoTexto)
                                                seccaoDiv.appendChild(seccaoTitulo)
                                            }

                                            seccoes.appendChild(seccaoDiv)
                                        }
                                       
                                    }
                                    
    
                                } else {
                                    console.log('No such document!')
                                }
                            }).catch(
                                error => {
                                    console.log('Error getting document:', error)
                       
                    })
                }
                ).catch(
                    error => {
                        console.log('Error getting Firestore instance:', error)
                    }
                )
    
    </script>